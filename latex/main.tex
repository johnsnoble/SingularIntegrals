\documentclass{article}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx} % Required for inserting images
\usepackage{mathtools}

\mathtoolsset{showonlyrefs}

\title{FYP}
\author{Johns Noble}
\date{January 2025}

\begin{document}

\maketitle

\newpage
\tableofcontents
\newpage

\section{Introduction}
\subsection{Cauchy Transform}
\begin{equation} \label{cauchy transform}
C_\Gamma f(z):=\frac{1}{2\pi i}\int_\Gamma \frac{f(t)}{t-z}dt
\end{equation}
This is analytic for $z \not\in \Gamma$. Define Hilbert Transform to be the limits from the right and the left.
\subsection{Orthogonal Polynomials}
\begin{center}
\begin{tabular}{ |c|c|c|c| } 
 \hline
	Family & Notation & Interval & $w(x)$ \\ 
 \hline
	Legendre & $P_n(x)$ & [-1,1] & $1$ \\ 
	Chebyshev (1st) & $T_n(x)$ & [-1,1] & $(1-x^2)^{-1/2}$ \\ 
	Chebyshev (2nd) & $U_n(x)$ & [-1,1] & $(1-x^2)^{1/2}$ \\
	Ultraspherical & $C_n^{(\lambda)}(x),\:\lambda>-\frac{1}{2}$ & [-1,1] & $(1-x^2)^{\lambda-1/2}$ \\
	Jacobi & $P_n^{(\alpha,\beta)}(x),\:\alpha,\beta>-1$ & [-1,1] & $(1-x)^\alpha(1-x)^\beta$ \\
 \hline
\end{tabular}
\end{center}
\section{Log and Stieltjes Transform}
In this section we will consider approaches to compute these weakly singular integrals
$$ \int_Alog||z-t||f(t)dt \qquad \int_A\mathbf{\nabla}log||z-t||f(t)dt $$
\begin{equation}\label{stieltjes transform}
	\mathcal{S}_Af(z):= \int_A\frac{f(t)}{z-t}dt \\
\end{equation}
\begin{equation}\label{log transform}
	\mathcal{L}_Af(z):= \int_Alog(z-t)f(t)dt
\end{equation}
Depending on the type of area which $A$ is we can begin by approximating $f$ using orthogonal polynomials.
\subsection{Transforms across Intervals}
We will try to formulate recurrence relations for these transforms across interval [-1, 1].
We are looking for looking for $\mathcal{S}_{[-1,1]}f(z)$.
Decomposing $f(z) \approx \Sigma_k f_kP_k(z)$ and writing $S_k(z):=\mathcal{S}_{[-1,1]}P_k(z)$ lets us write:
$$\mathcal{S}_{[-1,1]}f(z) \approx \Sigma_k f_kS_k(z)$$
This motivates finding fast methods to compute $S_k(z)$. Log kernels are approached similarly letting $L_k(z):=\mathcal{L}_{[-1,1]}P_k(z)$ and looking for recurrence relations.
\subsubsection*{Stieltjes}
Recall recurrence relation of Legendre Polynomials:
\begin{equation}\label{legendre recurrence}
	xP_k(x) = \frac{k}{2k+1}P_{k-1}(x) + \frac{k+1}{2k+1}P_{k+1}(x)
\end{equation}
Formulate three-term recurrence for their Stieltjes transforms.
\begin{equation}
\begin{split}
	zS_k(z) &= \int_{-1}^{1}\frac{zP_k(t)}{z-t}dt \\
	&= \int_{-1}^{1}\frac{z-t}{z-t}P_k(t)dt+\int_{-1}^{1}\frac{tP_k(t)}{z-t}dt \\
	&= \int_{-1}^{1}P_k(t)dt+\frac{k}{2k+1}\int_{-1}^{1}\frac{P_{k-1}(t)}{z-t}dt+\frac{k+1}{2k+1}\int_{-1}^{1}\frac{P_{k+1}(t)}{z-t}dt \\
	&= 2\delta_{k0}+\frac{k}{2k+1}S_{k-1}(z)+\frac{k+1}{2k+1}S_{k+1}(z) \\
	S_0(z) &= \int_{-1}^{1}\frac{dt}{z-t} = log(z+1)-log(z-1)
\end{split}
\end{equation}
We can extend this to work over a square using the recurrence over intervals:
\begin{equation}
\begin{split}
zS_{k,j}(z) &= z\int_{-1}^1\int_{-1}^1\frac{P_k(s)P_j(t)}{z-(s+it)}dsdt \\
&= \int_{-1}^1zP_j(t)\int_{-1}^1\frac{P_k(s)}{z-it-s}dsdt \\
&= \int_{-1}^1(z-it)P_j(t)S_k(z-it)+itP_j(t)S_k(z-it)dsdt \\
&= \int_{-1}^1P_j(t)(\frac{k}{2k+1}S_{k-1}(z-it)+\frac{k+1}{2k+1}S_{k+1}(z-it)+2\delta_{k0}) \\
&+i(\frac{j}{2j+1}P_{j-1}(t)+\frac{j+1}{2j+1}P_{j+1}(t))S_k(z-it)dsdt \\
&= \frac{k}{2k+1}S_{k-1,j}(z)+\frac{k+1}{2k+1}S_{k+1,j} \\
&+i\frac{j}{2j+1}S_{k,j-1}(z)+i\frac{j+1}{2j+1}S_{k,j+1}+4\delta_{j0}\delta{k0}
\end{split}
\end{equation}
\subsubsection*{Log}
We can begin by connecting log kernel to the Stieltjes kernel. To do this we define:$$S_k^{(\lambda)}(z):=\int_{-1}^{1}\frac{C_k^{(\lambda)}(t)}{z-t}dt$$
We let $F(x) = \int_{-1}^1f(s)ds$ and apply integration by parts on log transform:
\begin{equation}
\begin{split}
	\int_{-1}^1f(t)log(z-t)dt &= [-F(t)log(z-t)]_{-1}^1-\int_{-1}^1\frac{F(t)}{z-t}dt \\
	&= log(z+1)\int_{-1}^1f(t)dt-\int_{-1}^1\frac{F(t)}{z-t}dt
\end{split}
\end{equation}

\section{Polynomial Transforms}
We can begin to consider taking these transforms across different geometries.
Currently we have a way to find these transforms across [-1,1] but we will be trying to use this to solve other geometries.
The first type of geometry we should consider is one where we apply a degree $d$ polynomial transform to the interval:
$$p:[-1,1]\rightarrow \Gamma$$
We will show why the solution to a cauchy transform across this interval is as follows:
\begin{equation}
C_\Gamma f(z) = \Sigma_{j=0}^dC_{[-1,1]}[f\circ p](p_j^{-1}(z))
\end{equation}
Where $p_j^{-1}(z)$ are the $d$ pre-images of $p$.
In order to solve this we will use plemelj.
There are 3 properties that need to hold for a function $\psi: \Gamma \rightarrow \mathbb{C}$ to be a cauchy transform:
\begin{equation}\label{cauchy_conditions}\begin{gathered}
\underset{z\to\infty}{lim}= 0 \\
\psi^+(z)-\psi^-(z)= f(z) \\
\psi\;analytic\;on\;\Gamma 
\end{gathered}\end{equation}

Checking \eqref{cauchy_conditions}.1 we get that $\underset{z\to\infty}{p_j^{-1}(z)} = \infty \implies$
\begin{equation}\begin{split}
\underset{z\to\infty}{lim}C_\Gamma f(z) &= \Sigma_{j=1}^d \underset{z\to\infty}{lim}C_{[-1,1]}(f\circ p)(p_j^{-1}(z)) \\
&= \Sigma_{j=1}^d C_{[-1,1]}(f\circ p)(\underset{z\to\infty}{lim} p_j^{-1}(z)) \\
&= \Sigma_{j=1}^d 0 = 0
\end{split}\end{equation}

Checking \eqref{cauchy_conditions}.2 we need an expression for $\psi^+$ and $\psi^-$.
Let us begin by saying that we are looking for cauchy transform of point $s$ which happens to lie on $\Gamma$.
This means that there is a unique root of $t_k := p_k^{-1}(s) \in [-1,1]$.
TODO: Show that $\underset{z\to s^+}{lim} p_k^{-1}(s) =\underset{z\to p^{-1}(s)^+}{lim}$.
Taking limits of $\psi^+, \psi^-$ gives us:
\begin{equation}\begin{split}
\psi^+(s)&=\underset{z\to s}{lim}\:C_{[-1,1]}(f\circ p)(p_k^{-1}(z)) \\
&+\Sigma_{j\neq k}C_{[-1,1]}(f\circ p)(p_j^{-1}(s)) \\
&=C^+_{[-1,1]}(f\circ p)(p_k^{-1}(z)) \\
&+\Sigma_{j\neq k}C_{[-1,1]}(f\circ p)(p_j^{-1}(s)) \\
\end{split}\end{equation}
We can do a similar thing with $\psi^-$ and putting everything together:
\begin{equation}\begin{split}
\psi^+(s)-\psi^-(s)&=C_{[-1,1]}^+(f\circ p)(p_k^{-1}(s))-C_{[-1,1]}^-(f\circ p)(p_k^{-1}(s)) \\
&= (f\circ p)(p_k^{-1}(s)) = f(s)
\end{split}\end{equation}
In the case where $z \notin \psi, \psi^+=\psi^-$ which is expected since the area in between is analytic

TODO show that condition \eqref{cauchy_conditions}.3 holds
\section{Affine Transformations}
Affine transformations can be solved in 2 distinct ways:
We will begin by considering the case of solving for a horizontally skewed square with the following transformation:
$$\begin{pmatrix}x\\y\end{pmatrix}\rightarrow
\begin{pmatrix}\alpha x+\beta y\\y\end{pmatrix}$$
It can be shown that any affine transformation in the form of $(x, y)^T \rightarrow A(x,y)^T$ can be done by taking the above translation and performing scaling and rotations.
TODO: Show that this is indeed the case

\section{Quad Transform}
We can attempt to generalise the method of stieltjes on a square to work for any given quadrilateral. We can use the parameterisation: $$Q\begin{pmatrix}x\\y\end{pmatrix}\rightarrow
\begin{pmatrix}(1+x)(\alpha+\beta y)\\y\end{pmatrix}$$

There are two approaches which were considered which vary in which functions we are using for our bases.
The first approach that was attempted would be to take the function approximation as follows:
$$f(x,y)=\Sigma_{j,k}c_{j,k}P_j(x)P_k(y), c_{j,k}\in \mathbb{R}$$
This method is simpler but it can be seen that we would have to be evaluating integrals of orthogonal polynomials outside the
$[-1,1]$ domain in which they are well behaved.
This would result in instable results

The approach we will focus on here is the approximation following taking an approximation using the function bases as follows:
$$f\circ Q(x,y)= \Sigma_{j,k}c_{j,k}P_j(x)P_k(y), c_{j,k}\in \mathbb{R}$$
In this approach we are need to be able to compute $$s_{kj}:=\int_{-1}^1 (\alpha+\beta t) \int_{-1}^1 \frac{P_j(t)P_k(s)}
{z-it-(\alpha+\beta t)(1+s)} ds dt$$
As you can see here there is a term in the denominator which is difficult to deal with as it is harder to seperate the $s$ and $t$ terms.
In order to begin we come up with a few different rearrangements of this equation:
\begin{align}
\tilde{s_{kj}} :&= \int_{-1}^1 \int_{-1}^1 \frac{P_j(t)P_k(s)}
{z-it-(\alpha+\beta t)(1+s)} ds dt\\
&= \int_{-1}^1\frac{1}{\alpha+\beta t}\int_{-1}^1 \frac{P_j(t)P_k(s)}
{\frac{z-it}{\alpha+\beta t}-1-s}dsdt\\
&=: \int_{-1}^1\frac{P_j(t)}{\alpha+\beta t}\int_{-1}^1 \frac{P_k(s)}{\tilde{z_t}-s} \\
\tilde{s_{kj}} &= \int_{-1}^1\int_{-1}^1
\frac{P_j(t)P_k(s)}{z-\alpha(1+s)-(i+\beta(1+s))t}dsdt \\
&= \int_{-1}^1\frac{P_k(s)}{\beta(1+s)+i}\int_{-1}^1 \frac{P_j(t)}{
	\frac{z-\alpha(1+s)}{\beta(1+s)+i}-t}dtds\\
&= \int_{-1}^1\frac{P_k(s)}{\beta(1+s)+i}\int_{-1}^1 \frac{P_j(t)}{
\tilde{z_s}-t}dtds\\
\end{align}

Here, I've used $\tilde{z_t}$ and $\tilde{z_s}$ to denote different constants although rigorously both are actually two different functions.
It is always the case where $\tilde{z_t}, \tilde{z_s}$ denotes
$\frac{z-it}{\alpha+\beta t}-1,\frac{z-\alpha(1+s)}{\beta(1+s)+i}$ respectively

It is also very useful to define function $s_k, s_j$:
\begin{align}
	s_k(z) :&= \int_{-1}^1\frac{P_k(s)}{z-s}ds \\ 
	s_j(z) :&= \int_{-1}^1\frac{P_j(t)}{z-t}dt \\ 
\end{align}

This can be motivated by the tricky recurrent forms for $\tilde{s_{k0}}$.
TODO: Show why tricky?

We can recreate $s_{kj}$ using values of $\tilde{s_{kj}}$ by doing the following:
\begin{align}
	let\; I(k,j,s,t) :&= \frac{P_j(t)P_k(s)}{z-it-(\alpha+\beta t)(1+s)}\\ 
	s_{kj} &= \int_{-1}^1(\alpha+\beta t)\int_{-1}^1 I(k,j,s,t) dsdt\\
	&= \int_{-1}^1\alpha\int_{-1}^1 I(k,j,s,t)dsdt +
	\int_{-1}^1\beta t\int_{-1}^1 I(k,j,s,t) dsdt\\
	&= \alpha\tilde{s_{kj}} + \beta\frac{j}{2j+1}\tilde{s_{kj-1}} + \beta\frac{j+1}{2j+1}\tilde{s_{kj+1}} \\
	s_{k0} &= \int_{-1}^1\alpha\int_{-1}^1 I(k,0,s,t)dsdt +
	\int_{-1}^1\beta t\int_{-1}^1 I(k,0,s,t) dsdt \\
	&= \alpha\tilde{s_{k0}} + \beta\tilde{s_{k1}}
\end{align}

\subsection{Recurrences}

Now we can go about trying to construct these recurrences.
To make it easier notationally to represent these legendre recurrence relations, it is convenient to represent it as the following:
\begin{align}
    xP_j(x) &= \frac{j}{2j+1}P_{j-1}(x)+\frac{j+1}{2j+1}P_{j+1}(x) \\
    &:= j_-P_{j-1}(x)+j_+P_{j+1}(x)
\end{align}
It is easiest to begin with a case where:

\subsubsection*{Case 1: $k,j>1$}

\begin{align}
	z\tilde{s_{kj}}&=\int_{-1}^1z\frac{P_j(t)}{\alpha+\beta t}s_k(\tilde{z_t})dt\\
	&=\int_{-1}^1P_j(t)\frac{z-it}{\alpha+\beta t}s_k(\tilde{z_t})dt
	+\int_{-1}^1\frac{itP_j(t)}{\alpha+\beta t}s_k(\tilde{z_t})dt\\
	&=\int_{-1}^1P_j(t)\tilde{z_t}s_k(\tilde{z_t})dt
	+\int_{-1}^1P_j(t)s_k(\tilde{z_t})
	+\int_{-1}^1\frac{itP_j(t)}{\alpha+\beta t}s_k(\tilde{z_t})dt\\
\end{align}

It is useful here to come up with an expression for:

\begin{align}
    \int_{-1}^1P_j(t)s_k(\tilde{z_t}) &= \int_{-1}^1(\alpha+\beta t)\frac{P_j(t)}{\alpha + \beta t} s_k(\tilde{z_t})dt\\
    &= \int_{-1}^1\frac{\alpha P_j(t)}{\alpha+\beta t}s_k(\tilde{z_t})dt+\int_{-1}^1\frac{\beta tP_j(t)}{\alpha+\beta t}s_k(\tilde{z_t})dt\\
    &= \alpha\tilde{s_{kj}} + \beta j_-\tilde{s_{kj-1}}+\beta j_+\tilde{s_{kj+1}}
\end{align}

Similarly:
\begin{align}
    \int_{-1}^1P_k(s)s_j(\tilde{z}_s)ds &= \int_{-1}^1(\beta(1+s)+i)\frac{P_k(s)}{\beta(1+s)+i}s_j(\tilde{z}_s)ds\\
    &=\int_{-1}^1(\beta+i+\beta s)\frac{P_k(s)}{\beta(1+s)+i}s_j(\tilde{z}_s)ds\\
    &=(\beta+i)\tilde{s}_{kj}+\beta k_-\tilde{s}_{k-1j}+\beta k_+\tilde{s}_{k+1j}
\end{align}

Decomposing individual elements of the previous equation:

\begin{align}
	\int_{-1}^1P_j(t)\tilde{z_t}s_k(\tilde{z_t})dt&=\int_{-1}^1P_j(t)(k_-s_{k-1}(\tilde{z_t})+k_+s_{k+1}(\tilde{z_t}))dt\\
	&= k_-(\alpha\tilde{s_{k-1j}}+\beta j_-\tilde{s_{k-1j-1}}+\beta j_+\tilde{s_{k-1j+1}})\\
	&+ k_+(\alpha\tilde{s_{k+1j}}+\beta j_-\tilde{s_{k+1j-1}}+\beta j_+\tilde{s_{k+1j+1}})\\
	\int_{-1}^1P_j(t)s_k(\tilde{z_t}) &= \alpha\tilde{s_{kj}} + \beta j_-\tilde{s_{kj-1}}+\beta j_+\tilde{s_{kj+1}}\\
	\int_{-1}^1\frac{itP_j(t)}{\alpha+\beta t}s_k(\tilde{z_t})dt &= i(j_-\tilde{s_{kj-1}}+j_+\tilde{s_{kj+1}})
\end{align}

Returning back to our original equation:

\begin{align}
    z\tilde{s_{kj}}&=\int_{-1}^1P_j(t)\tilde{z_t}s_k(\tilde{z_t})dt
    +\int_{-1}^1P_j(t)s_k(\tilde{z_t})
    +\int_{-1}^1\frac{itP_j(t)}{\alpha+\beta t}s_k(\tilde{z_t})dt\\
    &=\beta(k_-j_-\tilde{s}_{k-1j-1}+k_-j_+\tilde{s}_{k-1j+1}+k_+j_-\tilde{s}_{k+1j-1}+k_+j_+\tilde{s}_{k+1j+1})\\
    &+\alpha(\tilde{s}_{kj}+k_-\tilde{s}_{k-1j}+k_+\tilde{s}_{k+1j})\\
    &+(\beta+i)(j_-\tilde{s}_{kj-1}+j_+\tilde{s}{kj+1})
\end{align}

And thus we have a 9 point stencil recurrence relation.
Given any 8 points we are able to find the final point.
Assuming we therefore for some $k,j\geq 2$ we have all $\tilde{s}_{nm}$ for all $n\leq k,m\leq j$,
we can compute the value of $\tilde{s}_{k+1j+1}$ since we other values $mn$ centered around $kj$.
Now we need a way of finding the base case, in particular, the case of the two initial rows and columns.

To begin with the computations of the $k=1,j=1$ rows/cols, it is useful to prove the following:
\begin{align}
    zs_0(z)&=\int_{-1}^1\frac{z}{z-s}ds \\
    &= \int_{-1}^11+\frac{s}{z-s}ds\\
    &= 2+s_1(z)
\end{align}

\subsubsection*{Case 2: $k=1$}
For this we are going to assume that we already have values of the following: $\tilde{s}_{kj}$ where both $k\leq1 \wedge j\leq1$ as well as for all $k=0$ and $j=0$.
Computation of these will be another case outlined later.
We are able to find a 6 point stencil relation by first beginning with the expansion for $z\tilde{s}_{0j}$
\begin{align}
    z\tilde{s}_{0j}&=\int_{-1}^1\frac{zP_j(t)}{\alpha+\beta t}s_0(\tilde{z}_t)dt\\
    &= \int_{-1}^1P_j(t)\frac{z-it}{\alpha+\beta t}s_0(\tilde{z}_t)dt
    +\int_{-1}^1\frac{itP_j(t)}{\alpha+\beta t}s_0(\tilde{z}_t)dt\\
    &= \int_{-1}^1P_j(t)\tilde{z}_ts_0(\tilde{z}_t)dt
    +\int_{-1}^1P_j(t)s_0(\tilde{z}_t)dt
    +\int_{-1}^1\frac{itP_j(t)}{\alpha+\beta t}s_0(\tilde{z}_t)dt\\
    &= \int_{-1}^1P_j(t)(2+s_1(\tilde{z}_t))dt
    +\alpha \tilde{s}_{0j}+\beta j_-\tilde{s}_{0j-1}+\beta j_+\tilde{s}_{0j+1}
    +i j_-\tilde{s}_{0j-1}+i j_+\tilde{s}_{0j+1}\\
    &=4\delta_{0j}+\alpha(\tilde{s}_{0j}+\tilde{s}_{1j})
    +\beta j_-(\tilde{s}_{0j-1}+\tilde{s}_{1j-1})+\beta j_+(\tilde{s}_{0j+1}+\tilde{s}_{1j+1})\\
    &+i j_-\tilde{s}_{0j-1}+i j_+\tilde{s}_{0j+1} \\
    &=4\delta_{0j}+\alpha(\tilde{s}_{0j}+\tilde{s}_{1j})
    +(\beta+i)(j_-(\tilde{s}_{0j-1}+\tilde{s}_{1j-1})+j_+(\tilde{s}_{0j+1}+\tilde{s}_{1j+1}))
\end{align}

\subsubsection*{Case 3: $j=1$}
We can use a similar approach for expansion on $z\tilde{s}_{k0}$:
\begin{align}
    z\tilde{s}_{k0} &= \int_{-1}^1\int_{-1}^1\frac{zP_k(s)}{z-it-(\alpha+\beta t)(1+s)}dsdt\\
    &=\int_{-1}^1\frac{zP_k(s)}{\beta(1+s)+i}\int_{-1}^1\frac{1}{\tilde{z}_s-t}dtds\\
    &=\int_{-1}^1\frac{zP_k(s)}{\beta(1+s)+i}s_0(\tilde{z}_s)ds\\
    &=\int_{-1}^1\frac{(z-\alpha(1+s))P_k(s)}{\beta(1+s)+i}s_0(\tilde{z}_s)ds
    +\int_{-1}^1\frac{\alpha(1+s)P_k(s)}{\beta(1+s)+i}s_0(\tilde{z}_s)ds\\
    &=\int_{-1}^1P_k(s)\tilde{z}_ss_0(\tilde{z}_s)ds
    +\int_{-1}^1\frac{\alpha(1+s)P_k(s)}{\beta(1+s)+i}s_0(\tilde{z}_s)ds\\
    &=\int_{-1}^1P_k(s)(2+s_1(\tilde{z}_s))ds+\alpha(\tilde{s}_{k0}+k_-\tilde{s}_{k-10}+k_+\tilde{s}_{k+10})\\
    &=(\beta+i)\tilde{s}_{k1}+\beta k_-\tilde{s}_{k-11}+\beta k_+\tilde{s}_{k+11}
    +\alpha(\tilde{s}_{k0}+k_-\tilde{s}_{k-10}+k_+\tilde{s}_{k+10})\\
\end{align}

Before moving to the next two cases we need closed form solutions to the following:

First we define: $$r_k = \int_{-1}^1P_j(t)s_0(\tilde{z}_t)dt$$
It is easy to see here that $r_k = s_{k0}$; we are able to very easily find a recurrence relation for $s_{k0}$:
\begin{align}
    r_k &= \int_{-1}^1P_j(t)s_0(\tilde{z}_t)dt\\
    &=\int_{-1}^1P_j(t)log(\frac{\tilde{z}_t+1}{\tilde{z}_t-1})dt\\
    &=\int_{-1}^1P_j(t)log(\frac{z-it}{z-2\alpha-(2\beta+i)t})dt\\
    &=\int_{-1}^1P_j(t)log(z-it)dt-\int_{-1}^1P_j(t)log(z-2\alpha-(2\beta+i)t)dt\\
    &=\int_{-1}^1P_j(t)log(z-it)dt
    -\int_{-1}^1P_j(t)(log(\frac{2\beta+i}{i})+log(\frac{(z-2\alpha)i}{2\beta+i}-it))dt\\
    &=M_j(z)-2\delta_{j0}log(1+\frac{2\beta}{i})-M_j(\frac{(z-2\alpha)i}{2\beta+i})
\end{align}

We also need to show that it is valid to split up these logs and prove that there will not exist any branch cuts.
TODO: Show that there are no branch cuts here

Secondly we should also define:
\begin{align}
    q_k&=\int_{-1}^1P_k(s)s_0(\tilde{z}_s)ds\\
    &=\int_{-1}^1P_k(s)log(\frac{\tilde{z}_s+1}{\tilde{z}_s-1})ds
    =\int_{-1}^1P_k(s)log(\frac{z+i-(\alpha-\beta)(1+s)}{z-i-(\alpha+\beta)(1+s)})ds\\
    &=\int_{-1}^1P_k(s)log(z+i-(\alpha-\beta)(1+s))ds+\int_{-1}^1P_k(s)log(z-i-(\alpha+\beta)(1+s))ds\\
    &=\int_{-1}^1P_k(s)(log(\frac{\alpha-\beta}{i})+log(\frac{i(z-i)}{\alpha-\beta}-i+is))ds\\
    &+\int_{-1}^1P_k(s)(log(\frac{\alpha+\beta}{i})+log(\frac{i(z-i)}{\alpha+\beta}-i+is))ds\\
    &=M_k(\frac{i(z-i)}{\alpha-\beta}-i)-M_k(\frac{i(z-i)}{\alpha+\beta}-i)
    +2\delta_{k0}log(\frac{\alpha-\beta}{\alpha+\beta})
\end{align}
TODO: Prove there are no branch cuts here

\subsubsection*{Case 4: $k=0$}
For this case we are considering how to solve the following:
\begin{align}
    \tilde{s}_{0j} &= \int_{-1}^1\frac{P_j(t)}{\alpha+\beta t}s_0(\tilde{z}_t)dt\\
    &= \int_{-1}^1\frac{P_j(t)}{\alpha+\beta t}\frac{log(\tilde{z}_t+1)}{log(\tilde{z}_t-1)}dt
\end{align}
This is difficult to find a closed form solution for, especially for all values of $j$.
We will later be forced into solving this problem with the use of dilogarithms, but we can do it in a way where we only have to do this once rather than for every value of $j$.

We can do the use the fact that we are able to compute all $r_k=s_{k0}$ to help us compute $\tilde{s}_{k0}$.
It is easy to see the relation between $s_{k0}$ and $\tilde{s}_{k0}$ as:
\begin{align}
    s_{k0}&=\int_{-1}^1s_k(\tilde{z}_t)dt\\
    &=\int_{-1}^1\frac{\alpha+\beta t}{\alpha+\beta t}s_k(\tilde{z}_t)dt\\
    &=\alpha \tilde{s}_{k0} + \beta \tilde{s_{k1}}
\end{align}
\end{document}

